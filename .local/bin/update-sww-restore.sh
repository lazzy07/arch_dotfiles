#!/usr/bin/env bash
# Regenerates ~/.local/bin/swww-restore.sh with the latest wallpaper path.
set -euo pipefail

WALLPAPER_PATH="${1:-}"
RESTORE_SCRIPT="$HOME/.local/bin/swww-restore.sh"

if [[ -z "$WALLPAPER_PATH" ]]; then
  echo "No wallpaper path passed to update-swww-restore.sh" >&2
  exit 1
fi

cat > "$RESTORE_SCRIPT" <<EOF
#!/usr/bin/env bash
# Auto-generated by Matugen post_hook

set -euo pipefail
pgrep -x swww-daemon >/dev/null || { swww-daemon --format xrgb & sleep 0.3; }
swww img --transition-type center --outputs all "$WALLPAPER_PATH"
EOF

chmod +x "$RESTORE_SCRIPT"

